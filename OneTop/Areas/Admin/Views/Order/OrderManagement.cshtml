
@{
    Layout = "/Views/Shared/_AdminLayout.cshtml";
}

@model List<OneTop.Models.Order>

@section Styles {
    <link rel="stylesheet" href="~/admin/css/asset/css_part/Order/OrderManager.css" asp-append-version="true" />
}

<main class="admin-order-manager">
    <h1>Order Management</h1>

    <table class="order-table" aria-describedby="order-list">
        <thead>
            <tr>
                <th>Order ID</th>
                <th>User</th>
                <th>Order Date</th>
                <th>Total Amount</th>
                <th>Payment Method</th>
                <th>Status</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody id="order-list">
        @foreach (var order in Model)
        {
            <tr>
                <td>@order.OrderId</td>
                <td>
                    @(
                        order.User != null
                            ? (!string.IsNullOrWhiteSpace(order.User.FullName) ? order.User.FullName : order.User.Username)
                            : (order.UserId.HasValue ? ($"UserId: {order.UserId}") : "-")
                    )
                </td>
                <td>@(order.OrderDate?.ToString("g") ?? "-")</td>
                <td>@(order.TotalAmount?.ToString("C") ?? "-")</td>
                <td>@order.PaymentMethod</td>
                <td>@order.Status</td>
                <td>
                    <div class="action-buttons">
                        @if (order.Status == "Chờ xử lý")
                            {
                                <a class="btn btn-confirm"
                                   asp-area="Admin"
                                   asp-controller="Order"
                                   asp-action="Confirm"
                                   asp-route-id="@order.OrderId">
                                    Xác nhận
                                </a>

                                <a class="btn btn-cancel"
                                   asp-area="Admin"
                                   asp-controller="Order"
                                   asp-action="Cancel"
                                   asp-route-id="@order.OrderId">
                                    Hủy
                                </a>
                            }
                            else if (order.Status == "Đang giao")
                            {
                                <a class="btn btn-complete"
                                   asp-area="Admin"
                                   asp-controller="Order"
                                   asp-action="Complete"
                                   asp-route-id="@order.OrderId">
                                    Hoàn thành
                                </a>

                                <a class="btn btn-cancel"
                                   asp-area="Admin"
                                   asp-controller="Order"
                                   asp-action="Cancel"
                                   asp-route-id="@order.OrderId">
                                    Hủy
                                </a>
                            }
                            else if (order.Status == "Hủy")
                            {
                                <span class="status-text canceled">Đã hủy</span>
                            }
                        </div>
                    </td>

                   

            </tr>
        }
        </tbody>
    </table>
</main>
